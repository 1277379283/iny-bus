{"version":3,"file":"iny-bus.js","sources":["../src/enum.ts","../src/utils.ts","../src/EventBus.ts","../src/bus.ts"],"sourcesContent":["export enum EventTypeEnum {\n  // 普通事件\n  NORMAL_EVENT = 1,\n  // 一次性事件\n  ONCE_EVENT = 2\n}","/**\n * 创建唯一id\n */\n\nexport function createUid(): string {\n\n  return (Math.random()).toString().substr(2)\n}\n","import { Event, EventType } from './types'\nimport { EventTypeEnum } from './enum'\nimport { createUid } from './utils'\n\nclass EventBus {\n\n  /**\n   * 储存事件的容器\n   */\n  private events: Event[] = []\n\n  /**\n   * on 新增事件监听\n   * @param name 事件名\n   * @param execute 回调函数\n   * @returns { string } eventId 事件ID，用户取消该事件监听\n   */\n\n\n  on(name: string, execute: Function): string {\n  \n    return this.addEvent(name, EventTypeEnum.NORMAL_EVENT, execute)\n  }\n\n  /**\n   * one 只允许添加一次事件监听\n   * @param name 事件名\n   * @param execute 回调函数\n   * @returns { string } eventId 事件ID，用户取消该事件监听\n   */\n\n  once(name: string, execute: Function): string {\n\n    return this.addEvent(name, EventTypeEnum.ONCE_EVENT, execute)\n  }\n\n  /**\n   * remove 移除事件监听\n   * @param name 事件名\n   * @param eventId 移除单个事件监听需传入\n   * @returns { WxEventCenter } WxEventCenter WxEventCenter 实例\n   */\n\n  remove(name: string, eventId: string): EventBus {\n  \n    const events = this.events\n\n    for (let i = 0; i < events.length; i++) {\n\n      if (events[i].name === name) {\n\n        // 移除具体的操作函数\n        if (eventId && events[i].executes.length > 0) {\n\n          const eventIndex = events[i].executes.findIndex(item => item.id === eventId)\n\n          if (eventIndex !== -1) {\n  \n            events[i].executes.splice(eventIndex, 1)\n          }\n          \n        } else {\n\n          events.splice(i, 1)\n        }\n\n        return this\n      }\n    }\n    \n    return this\n  }\n\n\n  /**\n   * emit 派发事件\n   * @param name 事件名\n   * @param args 其余参数\n   * @returns { WxEventCenter } WxEventCenter WxEventCenter 实例\n   */\n\n  emit(name: string, ...args: any[]): EventBus {\n\n    const events = this.events\n\n    for (let i = 0; i < events.length; i++) {\n\n      if (name === events[i].name) {\n\n        const funcs = events[i].executes\n\n        funcs.forEach((item, i) => {\n          item.execute(...args)\n\n          if (item.eventType === EventTypeEnum.ONCE_EVENT) {\n            funcs.splice(i, 1)\n          }\n        })\n\n        return this\n      }\n    }\n\n    return this\n  }\n\n  /**\n   * 查找事件的方法\n   * @param name\n   */\n\n  find(name: string): Event | null {\n\n    const events = this.events\n\n    for (let i = 0; i < events.length; i++) {\n\n      if (name === events[i].name) {\n\n        return events[i]\n      }\n    }\n\n    return null\n  }\n\n  /**\n   * 添加事件的方法\n   * @param name\n   * @param execute\n   */\n\n  private addEvent(name: string, eventType: EventType, execute: Function): string {\n\n    const eventId = createUid()\n\n    const events = this.events\n\n    const event = this.find(name)\n\n    if (event !== null) {\n\n      event.executes.push({ id: eventId, eventType, execute })\n\n      return eventId\n    }\n\n    events.push({\n      name,\n      executes: [\n        {\n          id: eventId,\n          eventType,\n          execute\n        }\n      ]\n    })\n\n    return eventId\n  }\n}\n\nexport default EventBus","import { EventBusInstance } from \"./types\";\nimport EventBus from \"./EventBus\";\n\n\nfunction createInstance (): EventBusInstance {\n  const bus = new EventBus()\n  // @ts-ignore\n  return bus as EventBusInstance\n}\n\nconst bus = createInstance()\n\nbus.create = function create () {\n  return createInstance()\n}\n\nexport default bus"],"names":[],"mappings":"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"}